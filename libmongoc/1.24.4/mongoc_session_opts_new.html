
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-7301842-14"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-7301842-14');
</script>
<link rel="canonical" href="https://www.mongoc.org/libmongoc/current/mongoc_session_opts_new.html"/>
    <title>mongoc_session_opts_new() &#8212; libmongoc 1.24.4</title>
    <link rel="stylesheet" href="_static/readable.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/readable.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sphinx_highlight.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mongoc_session_opts_get_causal_consistency()" href="mongoc_session_opts_get_causal_consistency.html" />
    <link rel="prev" title="mongoc_session_opt_t" href="mongoc_session_opt_t.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
<div style="text-align: center; border: 1px solid gray; padding: 10px; background: #d4f1ff">
  This is an outdated version of the documentation.
  <a href="https://mongoc.org/libmongoc/current/mongoc_session_opts_new.html"
     style="color: black; font-weight: bold; text-decoration: underline;">
    See the current version of this page</a>.
</div>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="mongoc_session_opts_get_causal_consistency.html" title="mongoc_session_opts_get_causal_consistency()"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="mongoc_session_opt_t.html" title="mongoc_session_opt_t"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">libmongoc 1.24.4</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="api.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="mongoc_session_opt_t.html" accesskey="U">mongoc_session_opt_t</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="mongoc-session-opts-new">
<h1>mongoc_session_opts_new()<a class="headerlink" href="#mongoc-session-opts-new" title="Permalink to this heading">¶</a></h1>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">mongoc_session_opt_t</span><span class="w"> </span><span class="o">*</span>
<span class="nf">mongoc_session_opts_new</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</pre></div>
</div>
<p>Start a session with <a class="symbol reference internal" href="mongoc_client_start_session.html"><span class="doc">mongoc_client_start_session()</span></a>, use the session for a sequence of operations and multi-document transactions, then free it with <a class="symbol reference internal" href="mongoc_client_session_destroy.html"><span class="doc">mongoc_client_session_destroy()</span></a>. Any <a class="symbol reference internal" href="mongoc_cursor_t.html"><span class="doc">mongoc_cursor_t</span></a> or <a class="symbol reference internal" href="mongoc_change_stream_t.html"><span class="doc">mongoc_change_stream_t</span></a> using a session must be destroyed before the session, and a session must be destroyed before the <a class="symbol reference internal" href="mongoc_client_t.html"><span class="doc">mongoc_client_t</span></a> it came from.</p>
<p>By default, sessions are <a class="reference external" href="https://www.mongodb.com/docs/manual/core/read-isolation-consistency-recency/#causal-consistency">causally consistent</a>. To disable causal consistency, before starting a session create a <a class="symbol reference internal" href="mongoc_session_opt_t.html"><span class="doc">mongoc_session_opt_t</span></a> with <a class="symbol reference internal" href="#"><span class="doc">mongoc_session_opts_new()</span></a> and call <a class="symbol reference internal" href="mongoc_session_opts_set_causal_consistency.html"><span class="doc">mongoc_session_opts_set_causal_consistency()</span></a>, then free the struct with <a class="symbol reference internal" href="mongoc_session_opts_destroy.html"><span class="doc">mongoc_session_opts_destroy()</span></a>.</p>
<p>Unacknowledged writes are prohibited with sessions.</p>
<p>A <a class="symbol reference internal" href="mongoc_client_session_t.html"><span class="doc">mongoc_client_session_t</span></a> must be used by only one thread at a time. Due to session pooling, <a class="symbol reference internal" href="mongoc_client_start_session.html"><span class="doc">mongoc_client_start_session()</span></a> may return a session that has been idle for some time and is about to be closed after its idle timeout. Use the session within one minute of acquiring it to refresh the session and avoid a timeout.</p>
<p>See the example code for <a class="symbol reference internal" href="mongoc_session_opts_set_causal_consistency.html"><span class="doc">mongoc_session_opts_set_causal_consistency()</span></a>.</p>
</section>
<section id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Permalink to this heading">¶</a></h2>
<p>A new <a class="symbol reference internal" href="mongoc_session_opt_t.html"><span class="doc">mongoc_session_opt_t</span></a> that must be freed with <a class="symbol reference internal" href="mongoc_session_opts_destroy.html"><span class="doc">mongoc_session_opts_destroy()</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_abort_transaction.html"><span class="doc">mongoc_client_session_abort_transaction()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_advance_cluster_time.html"><span class="doc">mongoc_client_session_advance_cluster_time()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_advance_operation_time.html"><span class="doc">mongoc_client_session_advance_operation_time()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_commit_transaction.html"><span class="doc">mongoc_client_session_commit_transaction()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_destroy.html"><span class="doc">mongoc_client_session_destroy()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_get_client.html"><span class="doc">mongoc_client_session_get_client()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_get_cluster_time.html"><span class="doc">mongoc_client_session_get_cluster_time()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_get_lsid.html"><span class="doc">mongoc_client_session_get_lsid()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_get_operation_time.html"><span class="doc">mongoc_client_session_get_operation_time()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_get_opts.html"><span class="doc">mongoc_client_session_get_opts()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_get_server_id.html"><span class="doc">mongoc_client_session_get_server_id()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_start_transaction.html"><span class="doc">mongoc_client_session_start_transaction()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_session_t.html"><span class="doc">mongoc_client_session_t</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_client_start_session.html"><span class="doc">mongoc_client_start_session()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_session_opts_clone.html"><span class="doc">mongoc_session_opts_clone()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_session_opts_destroy.html"><span class="doc">mongoc_session_opts_destroy()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_session_opts_get_causal_consistency.html"><span class="doc">mongoc_session_opts_get_causal_consistency()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_session_opts_get_default_transaction_opts.html"><span class="doc">mongoc_session_opts_get_default_transaction_opts()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_session_opts_get_transaction_opts.html"><span class="doc">mongoc_session_opts_get_transaction_opts()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="#"><span class="doc">mongoc_session_opts_new()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_session_opts_set_causal_consistency.html"><span class="doc">mongoc_session_opts_set_causal_consistency()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_session_opts_set_default_transaction_opts.html"><span class="doc">mongoc_session_opts_set_default_transaction_opts()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_clone.html"><span class="doc">mongoc_transaction_opts_clone()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_destroy.html"><span class="doc">mongoc_transaction_opts_destroy()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_get_max_commit_time_ms.html"><span class="doc">mongoc_transaction_opts_get_max_commit_time_ms()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_get_read_concern.html"><span class="doc">mongoc_transaction_opts_get_read_concern()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_get_read_prefs.html"><span class="doc">mongoc_transaction_opts_get_read_prefs()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_get_write_concern.html"><span class="doc">mongoc_transaction_opts_get_write_concern()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_new.html"><span class="doc">mongoc_transaction_opts_new()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_set_max_commit_time_ms.html"><span class="doc">mongoc_transaction_opts_set_max_commit_time_ms()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_set_read_concern.html"><span class="doc">mongoc_transaction_opts_set_read_concern()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_set_read_prefs.html"><span class="doc">mongoc_transaction_opts_set_read_prefs()</span></a></div>
</div>
<div class="line-block">
<div class="line"><a class="symbol reference internal" href="mongoc_transaction_opts_set_write_concern.html"><span class="doc">mongoc_transaction_opts_set_write_concern()</span></a></div>
</div>
</div>
</section>
</section>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installing the MongoDB C Driver (libmongoc) and BSON library (libbson)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic-troubleshooting.html">Basic Troubleshooting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="guides.html">Guides</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="init-cleanup.html">Initialization and cleanup</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="errors.html">Error Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifecycle.html">Object Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="gridfs.html">GridFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_auto_encryption_opts_t.html">mongoc_auto_encryption_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_bulk_operation_t.html">mongoc_bulk_operation_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_change_stream_t.html">mongoc_change_stream_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_t.html">mongoc_client_encryption_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_datakey_opts_t.html">mongoc_client_encryption_datakey_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_rewrap_many_datakey_result_t.html">mongoc_client_encryption_rewrap_many_datakey_result_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_encrypt_opts_t.html">mongoc_client_encryption_encrypt_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_encrypt_range_opts_t.html">mongoc_client_encryption_encrypt_range_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_opts_t.html">mongoc_client_encryption_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_pool_t.html">mongoc_client_pool_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_session_t.html">mongoc_client_session_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_session_with_transaction_cb_t.html">mongoc_client_session_with_transaction_cb_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_t.html">mongoc_client_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_collection_t.html">mongoc_collection_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_cursor_t.html">mongoc_cursor_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_database_t.html">mongoc_database_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_delete_flags_t.html">mongoc_delete_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_find_and_modify_opts_t.html">mongoc_find_and_modify_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_file_list_t.html">mongoc_gridfs_file_list_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_file_opt_t.html">mongoc_gridfs_file_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_file_t.html">mongoc_gridfs_file_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_bucket_t.html">mongoc_gridfs_bucket_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_t.html">mongoc_gridfs_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_host_list_t.html">mongoc_host_list_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_index_opt_geo_t.html">mongoc_index_opt_geo_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_index_opt_t.html">mongoc_index_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_index_opt_wt_t.html">mongoc_index_opt_wt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_insert_flags_t.html">mongoc_insert_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_iovec_t.html">mongoc_iovec_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_optional_t.html">mongoc_optional_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_query_flags_t.html">mongoc_query_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_rand.html">mongoc_rand</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_read_concern_t.html">mongoc_read_concern_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_read_mode_t.html">mongoc_read_mode_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_read_prefs_t.html">mongoc_read_prefs_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_remove_flags_t.html">mongoc_remove_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_reply_flags_t.html">mongoc_reply_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_server_api_t.html">mongoc_server_api_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_server_api_version_t.html">mongoc_server_api_version_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_server_description_t.html">mongoc_server_description_t</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="mongoc_session_opt_t.html">mongoc_session_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_socket_t.html">mongoc_socket_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_ssl_opt_t.html">mongoc_ssl_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_buffered_t.html">mongoc_stream_buffered_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_file_t.html">mongoc_stream_file_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_socket_t.html">mongoc_stream_socket_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_t.html">mongoc_stream_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_tls_t.html">mongoc_stream_tls_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_topology_description_t.html">mongoc_topology_description_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_transaction_opt_t.html">mongoc_transaction_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_transaction_state_t.html">mongoc_transaction_state_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_update_flags_t.html">mongoc_update_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_uri_t.html">mongoc_uri_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_version.html">Version Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_write_concern_t.html">mongoc_write_concern_t</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="application-performance-monitoring.html">Application Performance Monitoring (APM)</a></li>
</ul>
<!-- Because full_index.rst includes everything that index.rst includes, we have to exclude index.rst from the table-of-contents. This page is simply a link forced into the sidebar (in conf.py) to avoid including full_index.rst in the ToC. -->
<ul><li class='toctree-l1'><a href="full_index.html">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2017-present, MongoDB, Inc.
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.
  </div>
  
  </body>
</html>