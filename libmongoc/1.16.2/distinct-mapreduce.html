
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-7301842-14"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-7301842-14');
</script>
<link rel="canonical" href="http://mongoc.org/libbson/current/distinct-mapreduce.html"/>
    <title>“distinct” and “mapReduce” &#8212; libmongoc 1.16.2</title>
    <link rel="stylesheet" href="_static/readable.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using libmongoc in a Microsoft Visual Studio project" href="visual-studio-guide.html" />
    <link rel="prev" title="Aggregation Framework Examples" href="aggregate.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
<div style="text-align: center; border: 1px solid gray; padding: 10px; background: #d4f1ff">
  This is an outdated version of the documentation.
  <a href="http://mongoc.org/libmongoc/current/distinct-mapreduce.html" 
     style="color: black; font-weight: bold; text-decoration: underline;">
    See the current version of this page</a>.
</div>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="visual-studio-guide.html" title="Using libmongoc in a Microsoft Visual Studio project"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="aggregate.html" title="Aggregation Framework Examples"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">libmongoc 1.16.2</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="guides.html" accesskey="U">Guides</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="distinct-and-mapreduce">
<h1>“distinct” and “mapReduce”<a class="headerlink" href="#distinct-and-mapreduce" title="Permalink to this headline">¶</a></h1>
<p>This document provides some practical, simple, examples to demonstrate the <code class="docutils literal notranslate"><span class="pre">distinct</span></code> and <code class="docutils literal notranslate"><span class="pre">mapReduce</span></code> commands.</p>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>First we’ll write some code to insert sample data:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">doc-common-insert.c</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Don&#39;t try to compile this file on its own. It&#39;s meant to be #included</span>
<span class="cm">   by example code */</span>

<span class="cm">/* Insert some sample data */</span>
<span class="kt">bool</span>
<span class="nf">insert_data</span> <span class="p">(</span><span class="n">mongoc_collection_t</span> <span class="o">*</span><span class="n">collection</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">mongoc_bulk_operation_t</span> <span class="o">*</span><span class="n">bulk</span><span class="p">;</span>
   <span class="k">enum</span> <span class="n">N</span> <span class="p">{</span> <span class="n">ndocs</span> <span class="o">=</span> <span class="mi">4</span> <span class="p">};</span>
   <span class="n">bson_t</span> <span class="o">*</span><span class="n">docs</span><span class="p">[</span><span class="n">ndocs</span><span class="p">];</span>
   <span class="n">bson_error_t</span> <span class="n">error</span><span class="p">;</span>
   <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kt">bool</span> <span class="n">ret</span><span class="p">;</span>

   <span class="n">bulk</span> <span class="o">=</span> <span class="n">mongoc_collection_create_bulk_operation_with_opts</span> <span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>

   <span class="n">docs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">BCON_NEW</span> <span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">BCON_DOUBLE</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="s">&quot;tags&quot;</span><span class="p">,</span> <span class="s">&quot;[&quot;</span><span class="p">,</span> <span class="s">&quot;dog&quot;</span><span class="p">,</span> <span class="s">&quot;cat&quot;</span><span class="p">,</span> <span class="s">&quot;]&quot;</span><span class="p">);</span>
   <span class="n">docs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">BCON_NEW</span> <span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">BCON_DOUBLE</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">),</span> <span class="s">&quot;tags&quot;</span><span class="p">,</span> <span class="s">&quot;[&quot;</span><span class="p">,</span> <span class="s">&quot;cat&quot;</span><span class="p">,</span> <span class="s">&quot;]&quot;</span><span class="p">);</span>
   <span class="n">docs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">BCON_NEW</span> <span class="p">(</span>
      <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">BCON_DOUBLE</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">),</span> <span class="s">&quot;tags&quot;</span><span class="p">,</span> <span class="s">&quot;[&quot;</span><span class="p">,</span> <span class="s">&quot;mouse&quot;</span><span class="p">,</span> <span class="s">&quot;cat&quot;</span><span class="p">,</span> <span class="s">&quot;dog&quot;</span><span class="p">,</span> <span class="s">&quot;]&quot;</span><span class="p">);</span>
   <span class="n">docs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">BCON_NEW</span> <span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">BCON_DOUBLE</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">),</span> <span class="s">&quot;tags&quot;</span><span class="p">,</span> <span class="s">&quot;[&quot;</span><span class="p">,</span> <span class="s">&quot;]&quot;</span><span class="p">);</span>

   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ndocs</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">mongoc_bulk_operation_insert</span> <span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="n">docs</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
      <span class="n">bson_destroy</span> <span class="p">(</span><span class="n">docs</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
      <span class="n">docs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">ret</span> <span class="o">=</span> <span class="n">mongoc_bulk_operation_execute</span> <span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ret</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Error inserting data: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="n">mongoc_bulk_operation_destroy</span> <span class="p">(</span><span class="n">bulk</span><span class="p">);</span>
   <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* A helper which we&#39;ll use a lot later on */</span>
<span class="kt">void</span>
<span class="nf">print_res</span> <span class="p">(</span><span class="k">const</span> <span class="n">bson_t</span> <span class="o">*</span><span class="n">reply</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">;</span>
   <span class="n">BSON_ASSERT</span> <span class="p">(</span><span class="n">reply</span><span class="p">);</span>
   <span class="n">str</span> <span class="o">=</span> <span class="n">bson_as_canonical_extended_json</span> <span class="p">(</span><span class="n">reply</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
   <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
   <span class="n">bson_free</span> <span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="distinct-command">
<h2>“distinct” command<a class="headerlink" href="#distinct-command" title="Permalink to this headline">¶</a></h2>
<p>This is how to use the <code class="docutils literal notranslate"><span class="pre">distinct</span></code> command to get the distinct values of <code class="docutils literal notranslate"><span class="pre">x</span></code> which are greater than <code class="docutils literal notranslate"><span class="pre">1</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">distinct.c</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span>
<span class="nf">distinct</span> <span class="p">(</span><span class="n">mongoc_database_t</span> <span class="o">*</span><span class="n">database</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">bson_t</span> <span class="o">*</span><span class="n">command</span><span class="p">;</span>
   <span class="n">bson_t</span> <span class="n">reply</span><span class="p">;</span>
   <span class="n">bson_error_t</span> <span class="n">error</span><span class="p">;</span>
   <span class="kt">bool</span> <span class="n">res</span><span class="p">;</span>
   <span class="n">bson_iter_t</span> <span class="n">iter</span><span class="p">;</span>
   <span class="n">bson_iter_t</span> <span class="n">array_iter</span><span class="p">;</span>
   <span class="kt">double</span> <span class="n">val</span><span class="p">;</span>

   <span class="n">command</span> <span class="o">=</span> <span class="n">BCON_NEW</span> <span class="p">(</span><span class="s">&quot;distinct&quot;</span><span class="p">,</span>
                       <span class="n">BCON_UTF8</span> <span class="p">(</span><span class="n">COLLECTION_NAME</span><span class="p">),</span>
                       <span class="s">&quot;key&quot;</span><span class="p">,</span>
                       <span class="n">BCON_UTF8</span> <span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">),</span>
                       <span class="s">&quot;query&quot;</span><span class="p">,</span>
                       <span class="s">&quot;{&quot;</span><span class="p">,</span>
                       <span class="s">&quot;x&quot;</span><span class="p">,</span>
                       <span class="s">&quot;{&quot;</span><span class="p">,</span>
                       <span class="s">&quot;$gt&quot;</span><span class="p">,</span>
                       <span class="n">BCON_DOUBLE</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>
                       <span class="s">&quot;}&quot;</span><span class="p">,</span>
                       <span class="s">&quot;}&quot;</span><span class="p">);</span>
   <span class="n">res</span> <span class="o">=</span>
      <span class="n">mongoc_database_command_simple</span> <span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">reply</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Error with distinct: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="cm">/* Do something with reply (in this case iterate through the values) */</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">bson_iter_init_find</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">iter</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">reply</span><span class="p">,</span> <span class="s">&quot;values&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
         <span class="n">BSON_ITER_HOLDS_ARRAY</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">iter</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
         <span class="n">bson_iter_recurse</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">iter</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">array_iter</span><span class="p">)))</span> <span class="p">{</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Couldn&#39;t extract </span><span class="se">\&quot;</span><span class="s">values</span><span class="se">\&quot;</span><span class="s"> field from response</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">while</span> <span class="p">(</span><span class="n">bson_iter_next</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">array_iter</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">BSON_ITER_HOLDS_DOUBLE</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">array_iter</span><span class="p">))</span> <span class="p">{</span>
         <span class="n">val</span> <span class="o">=</span> <span class="n">bson_iter_double</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">array_iter</span><span class="p">);</span>
         <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;Next double: %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
      <span class="p">}</span>
   <span class="p">}</span>

<span class="nl">cleanup</span><span class="p">:</span>
   <span class="cm">/* cleanup */</span>
   <span class="n">bson_destroy</span> <span class="p">(</span><span class="n">command</span><span class="p">);</span>
   <span class="n">bson_destroy</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">reply</span><span class="p">);</span>
   <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mapreduce-basic-example">
<h2>“mapReduce” - basic example<a class="headerlink" href="#mapreduce-basic-example" title="Permalink to this headline">¶</a></h2>
<p>A simple example using the map reduce framework. It simply adds up the number of occurrences of each “tag”.</p>
<p>First define the <code class="docutils literal notranslate"><span class="pre">map</span></code> and <code class="docutils literal notranslate"><span class="pre">reduce</span></code> functions:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">constants.c</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">COLLECTION_NAME</span> <span class="o">=</span> <span class="s">&quot;things&quot;</span><span class="p">;</span>

<span class="cm">/* Our map function just emits a single (key, 1) pair for each tag</span>
<span class="cm">   in the array: */</span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">MAPPER</span> <span class="o">=</span> <span class="s">&quot;function () {&quot;</span>
                           <span class="s">&quot;this.tags.forEach(function(z) {&quot;</span>
                           <span class="s">&quot;emit(z, 1);&quot;</span>
                           <span class="s">&quot;});&quot;</span>
                           <span class="s">&quot;}&quot;</span><span class="p">;</span>

<span class="cm">/* The reduce function sums over all of the emitted values for a</span>
<span class="cm">   given key: */</span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">REDUCER</span> <span class="o">=</span> <span class="s">&quot;function (key, values) {&quot;</span>
                            <span class="s">&quot;var total = 0;&quot;</span>
                            <span class="s">&quot;for (var i = 0; i &lt; values.length; i++) {&quot;</span>
                            <span class="s">&quot;total += values[i];&quot;</span>
                            <span class="s">&quot;}&quot;</span>
                            <span class="s">&quot;return total;&quot;</span>
                            <span class="s">&quot;}&quot;</span><span class="p">;</span>
<span class="cm">/* Note We can&#39;t just return values.length as the reduce function</span>
<span class="cm">   might be called iteratively on the results of other reduce</span>
<span class="cm">   steps. */</span>
</pre></div>
</div>
</div>
<p>Run the <code class="docutils literal notranslate"><span class="pre">mapReduce</span></code> command. Use the generic command helpers (e.g. <a class="symbol reference internal" href="mongoc_database_command_simple.html"><span class="doc">mongoc_database_command_simple()</span></a>).
Do not the read command helpers (e.g. <a class="symbol reference internal" href="mongoc_database_read_command_with_opts.html"><span class="doc">mongoc_database_read_command_with_opts()</span></a>) because they are considered
retryable read operations. If retryable reads are enabled, those operations will retry once on a retryable error,
giving undesirable behavior for <code class="docutils literal notranslate"><span class="pre">mapReduce</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">map-reduce-basic.c</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span>
<span class="nf">map_reduce_basic</span> <span class="p">(</span><span class="n">mongoc_database_t</span> <span class="o">*</span><span class="n">database</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">bson_t</span> <span class="n">reply</span><span class="p">;</span>
   <span class="n">bson_t</span> <span class="o">*</span><span class="n">command</span><span class="p">;</span>
   <span class="kt">bool</span> <span class="n">res</span><span class="p">;</span>
   <span class="n">bson_error_t</span> <span class="n">error</span><span class="p">;</span>
   <span class="n">mongoc_cursor_t</span> <span class="o">*</span><span class="n">cursor</span><span class="p">;</span>
   <span class="k">const</span> <span class="n">bson_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">;</span>

   <span class="kt">bool</span> <span class="n">query_done</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

   <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">out_collection_name</span> <span class="o">=</span> <span class="s">&quot;outCollection&quot;</span><span class="p">;</span>
   <span class="n">mongoc_collection_t</span> <span class="o">*</span><span class="n">out_collection</span><span class="p">;</span>

   <span class="cm">/* Empty find query */</span>
   <span class="n">bson_t</span> <span class="n">find_query</span> <span class="o">=</span> <span class="n">BSON_INITIALIZER</span><span class="p">;</span>

   <span class="cm">/* Construct the mapReduce command */</span>

   <span class="cm">/* Other arguments can also be specified here, like &quot;query&quot; or</span>
<span class="cm">      &quot;limit&quot; and so on */</span>
   <span class="n">command</span> <span class="o">=</span> <span class="n">BCON_NEW</span> <span class="p">(</span><span class="s">&quot;mapReduce&quot;</span><span class="p">,</span>
                       <span class="n">BCON_UTF8</span> <span class="p">(</span><span class="n">COLLECTION_NAME</span><span class="p">),</span>
                       <span class="s">&quot;map&quot;</span><span class="p">,</span>
                       <span class="n">BCON_CODE</span> <span class="p">(</span><span class="n">MAPPER</span><span class="p">),</span>
                       <span class="s">&quot;reduce&quot;</span><span class="p">,</span>
                       <span class="n">BCON_CODE</span> <span class="p">(</span><span class="n">REDUCER</span><span class="p">),</span>
                       <span class="s">&quot;out&quot;</span><span class="p">,</span>
                       <span class="n">BCON_UTF8</span> <span class="p">(</span><span class="n">out_collection_name</span><span class="p">));</span>
   <span class="n">res</span> <span class="o">=</span>
      <span class="n">mongoc_database_command_simple</span> <span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">reply</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;MapReduce failed: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="cm">/* Do something with the reply (it doesn&#39;t contain the mapReduce results) */</span>
   <span class="n">print_res</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">reply</span><span class="p">);</span>

   <span class="cm">/* Now we&#39;ll query outCollection to see what the results are */</span>
   <span class="n">out_collection</span> <span class="o">=</span>
      <span class="n">mongoc_database_get_collection</span> <span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">out_collection_name</span><span class="p">);</span>
   <span class="n">cursor</span> <span class="o">=</span> <span class="n">mongoc_collection_find_with_opts</span> <span class="p">(</span>
      <span class="n">out_collection</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">find_query</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
   <span class="n">query_done</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>

   <span class="cm">/* Do something with the results */</span>
   <span class="k">while</span> <span class="p">(</span><span class="n">mongoc_cursor_next</span> <span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">print_res</span> <span class="p">(</span><span class="n">doc</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">mongoc_cursor_error</span> <span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;ERROR: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>
      <span class="n">res</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>

<span class="nl">cleanup</span><span class="p">:</span>
   <span class="cm">/* cleanup */</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">query_done</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">mongoc_cursor_destroy</span> <span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
      <span class="n">mongoc_collection_destroy</span> <span class="p">(</span><span class="n">out_collection</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="n">bson_destroy</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">reply</span><span class="p">);</span>
   <span class="n">bson_destroy</span> <span class="p">(</span><span class="n">command</span><span class="p">);</span>

   <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mapreduce-more-complicated-example">
<h2>“mapReduce” - more complicated example<a class="headerlink" href="#mapreduce-more-complicated-example" title="Permalink to this headline">¶</a></h2>
<p>You must have replica set running for this.</p>
<p>In this example we contact a secondary in the replica set and do an “inline” map reduce, so the results are returned immediately:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">map-reduce-advanced.c</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span>
<span class="nf">map_reduce_advanced</span> <span class="p">(</span><span class="n">mongoc_database_t</span> <span class="o">*</span><span class="n">database</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">bson_t</span> <span class="o">*</span><span class="n">command</span><span class="p">;</span>
   <span class="n">bson_error_t</span> <span class="n">error</span><span class="p">;</span>
   <span class="kt">bool</span> <span class="n">res</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
   <span class="n">mongoc_cursor_t</span> <span class="o">*</span><span class="n">cursor</span><span class="p">;</span>
   <span class="n">mongoc_read_prefs_t</span> <span class="o">*</span><span class="n">read_pref</span><span class="p">;</span>
   <span class="k">const</span> <span class="n">bson_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">;</span>

   <span class="cm">/* Construct the mapReduce command */</span>
   <span class="cm">/* Other arguments can also be specified here, like &quot;query&quot; or &quot;limit&quot;</span>
<span class="cm">      and so on */</span>

   <span class="cm">/* Read the results inline from a secondary replica */</span>
   <span class="n">command</span> <span class="o">=</span> <span class="n">BCON_NEW</span> <span class="p">(</span><span class="s">&quot;mapReduce&quot;</span><span class="p">,</span>
                       <span class="n">BCON_UTF8</span> <span class="p">(</span><span class="n">COLLECTION_NAME</span><span class="p">),</span>
                       <span class="s">&quot;map&quot;</span><span class="p">,</span>
                       <span class="n">BCON_CODE</span> <span class="p">(</span><span class="n">MAPPER</span><span class="p">),</span>
                       <span class="s">&quot;reduce&quot;</span><span class="p">,</span>
                       <span class="n">BCON_CODE</span> <span class="p">(</span><span class="n">REDUCER</span><span class="p">),</span>
                       <span class="s">&quot;out&quot;</span><span class="p">,</span>
                       <span class="s">&quot;{&quot;</span><span class="p">,</span>
                       <span class="s">&quot;inline&quot;</span><span class="p">,</span>
                       <span class="s">&quot;1&quot;</span><span class="p">,</span>
                       <span class="s">&quot;}&quot;</span><span class="p">);</span>

   <span class="n">read_pref</span> <span class="o">=</span> <span class="n">mongoc_read_prefs_new</span> <span class="p">(</span><span class="n">MONGOC_READ_SECONDARY</span><span class="p">);</span>
   <span class="n">cursor</span> <span class="o">=</span> <span class="n">mongoc_database_command</span> <span class="p">(</span>
      <span class="n">database</span><span class="p">,</span> <span class="n">MONGOC_QUERY_NONE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">read_pref</span><span class="p">);</span>

   <span class="cm">/* Do something with the results */</span>
   <span class="k">while</span> <span class="p">(</span><span class="n">mongoc_cursor_next</span> <span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">print_res</span> <span class="p">(</span><span class="n">doc</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">mongoc_cursor_error</span> <span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;ERROR: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>
      <span class="n">res</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">mongoc_cursor_destroy</span> <span class="p">(</span><span class="n">cursor</span><span class="p">);</span>
   <span class="n">mongoc_read_prefs_destroy</span> <span class="p">(</span><span class="n">read_pref</span><span class="p">);</span>
   <span class="n">bson_destroy</span> <span class="p">(</span><span class="n">command</span><span class="p">);</span>

   <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-the-examples">
<h2>Running the Examples<a class="headerlink" href="#running-the-examples" title="Permalink to this headline">¶</a></h2>
<p>Here’s how to run the example code</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">basic-aggregation.c</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Copyright 2016 MongoDB, Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="cm"> * you may not use this file except in compliance with the License.</span>
<span class="cm"> * You may obtain a copy of the License at</span>
<span class="cm"> *</span>
<span class="cm"> *   http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="cm"> *</span>
<span class="cm"> * Unless required by applicable law or agreed to in writing, software</span>
<span class="cm"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="cm"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="cm"> * See the License for the specific language governing permissions and</span>
<span class="cm"> * limitations under the License.</span>
<span class="cm"> */</span>


<span class="cp">#include</span> <span class="cpf">&lt;mongoc/mongoc.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>


<span class="cp">#include</span> <span class="cpf">&quot;constants.c&quot;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;../doc-common-insert.c&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;distinct.c&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;map-reduce-basic.c&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;map-reduce-advanced.c&quot;</span><span class="cp"></span>


<span class="kt">int</span>
<span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">mongoc_database_t</span> <span class="o">*</span><span class="n">database</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
   <span class="n">mongoc_client_t</span> <span class="o">*</span><span class="n">client</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
   <span class="n">mongoc_collection_t</span> <span class="o">*</span><span class="n">collection</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
   <span class="n">mongoc_uri_t</span> <span class="o">*</span><span class="n">uri</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
   <span class="n">bson_error_t</span> <span class="n">error</span><span class="p">;</span>
   <span class="kt">char</span> <span class="o">*</span><span class="n">host_and_port</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
   <span class="kt">int</span> <span class="n">exit_code</span> <span class="o">=</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;usage: %s CONNECTION-STRING</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span>
               <span class="s">&quot;the connection string can be of the following forms:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;localhost</span><span class="se">\t\t\t\t</span><span class="s">local machine</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;localhost:27018</span><span class="se">\t\t\t\t</span><span class="s">local machine on port 27018</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span>
               <span class="s">&quot;mongodb://user:pass@localhost:27017</span><span class="se">\t</span><span class="s">&quot;</span>
               <span class="s">&quot;local machine on port 27017, and authenticate with username &quot;</span>
               <span class="s">&quot;user and password pass</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="k">return</span> <span class="n">exit_code</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">mongoc_init</span> <span class="p">();</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">strncmp</span> <span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&quot;mongodb://&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">host_and_port</span> <span class="o">=</span> <span class="n">bson_strdup</span> <span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">host_and_port</span> <span class="o">=</span> <span class="n">bson_strdup_printf</span> <span class="p">(</span><span class="s">&quot;mongodb://%s&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="p">}</span>

   <span class="n">uri</span> <span class="o">=</span> <span class="n">mongoc_uri_new_with_error</span> <span class="p">(</span><span class="n">host_and_port</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">uri</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span>
               <span class="s">&quot;failed to parse URI: %s</span><span class="se">\n</span><span class="s">&quot;</span>
               <span class="s">&quot;error message:       %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
               <span class="n">host_and_port</span><span class="p">,</span>
               <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">client</span> <span class="o">=</span> <span class="n">mongoc_client_new_from_uri</span> <span class="p">(</span><span class="n">uri</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">client</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">mongoc_client_set_error_api</span> <span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
   <span class="n">database</span> <span class="o">=</span> <span class="n">mongoc_client_get_database</span> <span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">&quot;test&quot;</span><span class="p">);</span>
   <span class="n">collection</span> <span class="o">=</span> <span class="n">mongoc_database_get_collection</span> <span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">COLLECTION_NAME</span><span class="p">);</span>

   <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;Inserting data</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">insert_data</span> <span class="p">(</span><span class="n">collection</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;distinct</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">distinct</span> <span class="p">(</span><span class="n">database</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;map reduce</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">map_reduce_basic</span> <span class="p">(</span><span class="n">database</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;more complicated map reduce</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">map_reduce_advanced</span> <span class="p">(</span><span class="n">database</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">goto</span> <span class="n">cleanup</span><span class="p">;</span>
   <span class="p">}</span>
   
   <span class="n">exit_code</span> <span class="o">=</span> <span class="n">EXIT_SUCCESS</span><span class="p">;</span>

<span class="nl">cleanup</span><span class="p">:</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">collection</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">mongoc_collection_destroy</span> <span class="p">(</span><span class="n">collection</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">database</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">mongoc_database_destroy</span> <span class="p">(</span><span class="n">database</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">mongoc_client_destroy</span> <span class="p">(</span><span class="n">client</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">uri</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">mongoc_uri_destroy</span> <span class="p">(</span><span class="n">uri</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">host_and_port</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">bson_free</span> <span class="p">(</span><span class="n">host_and_port</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="n">mongoc_cleanup</span> <span class="p">();</span>
   <span class="k">return</span> <span class="n">exit_code</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>If you want to try the advanced map reduce example with a secondary, start a replica set (instructions for how to do this can be found <a class="reference external" href="https://docs.mongodb.com/manual/tutorial/deploy-replica-set-for-testing/">here</a>).</p>
<p>Otherwise, just start an instance of MongoDB:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mongod
</pre></div>
</div>
<p>Now compile and run the example program:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cd examples/basic_aggregation/
$ gcc -Wall -o agg-example basic-aggregation.c $(pkg-config --cflags --libs libmongoc-1.0)
$ ./agg-example localhost

Inserting data
distinct
Next double: 2.000000
Next double: 3.000000
map reduce
{ &quot;result&quot; : &quot;outCollection&quot;, &quot;timeMillis&quot; : 155, &quot;counts&quot; : { &quot;input&quot; : 84, &quot;emit&quot; : 126, &quot;reduce&quot; : 3, &quot;output&quot; : 3 }, &quot;ok&quot; : 1 }
{ &quot;_id&quot; : &quot;cat&quot;, &quot;value&quot; : 63 }
{ &quot;_id&quot; : &quot;dog&quot;, &quot;value&quot; : 42 }
{ &quot;_id&quot; : &quot;mouse&quot;, &quot;value&quot; : 21 }
more complicated map reduce
{ &quot;results&quot; : [ { &quot;_id&quot; : &quot;cat&quot;, &quot;value&quot; : 63 }, { &quot;_id&quot; : &quot;dog&quot;, &quot;value&quot; : 42 }, { &quot;_id&quot; : &quot;mouse&quot;, &quot;value&quot; : 21 } ], &quot;timeMillis&quot; : 14, &quot;counts&quot; : { &quot;input&quot; : 84, &quot;emit&quot; : 126, &quot;reduce&quot; : 3, &quot;output&quot; : 3 }, &quot;ok&quot; : 1 }
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installing the MongoDB C Driver (libmongoc) and BSON library (libbson)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic-troubleshooting.html">Basic Troubleshooting</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="guides.html">Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mongoc-common-task-examples.html">Common Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-connections.html">Advanced Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="connection-pooling.html">Connection Pooling</a></li>
<li class="toctree-l2"><a class="reference internal" href="cursors.html">Cursors</a></li>
<li class="toctree-l2"><a class="reference internal" href="bulk.html">Bulk Write Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="aggregate.html">Aggregation Framework Examples</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">“distinct” and “mapReduce”</a></li>
<li class="toctree-l2"><a class="reference internal" href="visual-studio-guide.html">Using libmongoc in a Microsoft Visual Studio project</a></li>
<li class="toctree-l2"><a class="reference internal" href="create-indexes.html">Creating Indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Aids for Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_client_side_encryption.html">Using Client-Side Field Level Encryption</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="application-performance-monitoring.html">Application Performance Monitoring (APM)</a></li>
</ul>
<!-- Because full_index.rst includes everything that index.rst includes, we have to exclude index.rst from the table-of-contents. This page is simply a link forced into the sidebar (in conf.py) to avoid including full_index.rst in the ToC. -->
<ul><li class='toctree-l1'><a href="full_index.html">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2017-present, MongoDB, Inc.
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
  </div>
  
  </body>
</html>